<md-content layout="column" flex layout-padding>
<div ng-if="loading" layout-padding>
	<div layout="row" layout-sm="column" layout-align="space-around">
		<md-progress-circular md-diameter="60" md-mode="indeterminate"></md-progress-circular>
	</div>
</div>
<div ng-if="!loading" layout-padding layout="column">
	<md-subheader class="md-primary">
	<h4 class="md-title"
		ng-bind="documentEntity.id?'Edit Production Plan':'Add Production Plan'"></h4>
	</md-subheader>
	<div>
		<form name="entityForm">

			<div layout="row" layout-xs="column">
				<md-input-container flex> <input type="text"
					aria-label="period" placeholder="Title"
					ng-model="documentEntity.title" ng-required="true"> </md-input-container>

				<md-input-container flex> <input type="text"
					aria-label="period" placeholder="Discription"
					ng-model="documentEntity.note"> </md-input-container>
			</div>

			<div layout="row" layout-xs="column">
				<md-input-container flex> <input type="text"
					aria-label="period" placeholder="Sales Order No"
					ng-model="documentEntity.salesOrderNumber"> </md-input-container>

				<md-input-container flex> <input type="text"
					aria-label="period" placeholder="Customer Name"
					ng-model="documentEntity.tempField"> </md-input-container>
			</div>

			<div layout="row" layout-xs="column" flex="50" flex-xs="100">
				<mdp-date-picker flex mdp-placeholder="Plan Start Date"
					ng-model="documentEntity.fromDateTime" mdp-format="DD/MM/YYYY"></mdp-date-picker>

				<mdp-date-picker flex  mdp-placeholder="Plan End Date"
					ng-model="documentEntity.toDateTime" mdp-min-date="documentEntity.fromDateTime" mdp-format="DD/MM/YYYY"></mdp-date-picker>
			</div>

			<div ng-if="documentEntity.id">
				<!-- Show this part only if Object is created  -->
				<h4 ng-init="prodReqListToogle=true"
					ng-click="prodReqListToogle=!prodReqListToogle">
					Production Requisition List
					<md-button class="md-icon-button" ng-show="prodReqListToogle">
					<ng-md-icon icon="keyboard_arrow_up" style="fill: md-default"
						size="24"> <md-tooltip> Collapse</md-tooltip></ng-md-icon></md-button>
					<md-button class="md-icon-button" ng-show="!prodReqListToogle">
					<ng-md-icon icon="keyboard_arrow_down" style="fill: md-default"
						size="24"> <md-tooltip> Expand</md-tooltip></ng-md-icon></md-button>
				</h4>
				<div ng-show="prodReqListToogle">
					<md-button class="md-icon-button" ng-click="addProdReq($event)">
					<ng-md-icon icon="add_circle" style="fill: md-default" size="24">
					<md-tooltip> Add New </md-tooltip></ng-md-icon> </md-button>
					<md-table-container>
					<table md-table md-progress="promise">
						<thead ng-if="!dataTableOptions.decapitate" md-head
							md-order="query.order" md-on-reorder="logOrder">
							<tr md-row>
								<th md-column>Requisition No.</th>
								<th md-column>BOM Product</th>
								<th md-column>Delivery Date</th>
								<th md-column>Status</th>
								<th md-column>Action</th>
							</tr>
						</thead>
						<tbody md-body>
							<tr md-row
								ng-repeat="bomRequisitionEntity in documentEntity.prodRequisitionList">
								<td md-cell>{{bomRequisitionEntity.itemNumber}}</td>
								<td md-cell>{{bomRequisitionEntity.bomEntity.stockItemType.itemName}}</td>
								<td md-cell>{{bomRequisitionEntity.deliveryDateTime |
									formatDateWithTime}}</td>
								<td md-cell>{{bomRequisitionEntity.status}}</td>
								<td md-cell><md-button class="md-icon-button"
										ng-click="addProdReq($event, bomRequisitionEntity)">
									<ng-md-icon icon="edit" style="fill: md-default" size="20">
									<md-tooltip> Edit</md-tooltip></ng-md-icon></md-button> <md-button
										class="md-icon-button"
										ng-click="printProductRequisition(bomRequisitionEntity.id)">
									<ng-md-icon icon="print" style="fill: md-default" size="20">
									<md-tooltip> Print Product Requisition</md-tooltip></ng-md-icon></md-button></td>
							</tr>
						</tbody>
					</table>
					</md-table-container>
				</div>

				<h4 ng-init="prodShipListToogle=true"
					ng-click="prodShipListToogle=!prodShipListToogle">
					Production Shipment List
					<md-button class="md-icon-button" ng-show="prodShipListToogle">
					<ng-md-icon icon="keyboard_arrow_up" style="fill: md-default"
						size="24"> <md-tooltip> Collapse</md-tooltip></ng-md-icon></md-button>
					<md-button class="md-icon-button" ng-show="!prodShipListToogle">
					<ng-md-icon icon="keyboard_arrow_down" style="fill: md-default"
						size="24"> <md-tooltip> Expand</md-tooltip></ng-md-icon></md-button>
				</h4>
				<div ng-show="prodShipListToogle">
					<md-button class="md-icon-button" ng-click="addProdShip()">
					<ng-md-icon icon="add_circle" style="fill: md-default" size="24">
					<md-tooltip> Add New </md-tooltip></ng-md-icon> </md-button>
					<md-table-container>
					<table md-table md-progress="promise">
						<thead ng-if="!dataTableOptions.decapitate" md-head
							md-order="query.order" md-on-reorder="logOrder">
							<tr md-row>
								<th md-column md-order-by="itemNumber">Ship Item No.</th>
								<th md-column md-order-by="type">Shipment Date</th>
								<th md-column md-order-by="type">To Warehouse</th>
								<th md-column md-order-by="type">Action</th>
							</tr>
						</thead>
						<tbody md-body>
							<tr md-row
								ng-repeat="shipmentEntity in documentEntity.prodShipmentList">
								<td md-cell>{{$index+1}}</td>
								<td md-cell>{{shipmentEntity.shipmentDate | formatDateWithTime}}</td>
								<td md-cell>{{shipmentEntity.toWH.warehouseName }}</td> 
								<td md-cell><md-button class="md-icon-button"
										ng-click="addProdShip($event, shipmentEntity)">
									<ng-md-icon icon="edit" style="fill: md-default" size="20">
									<md-tooltip> Edit</md-tooltip></ng-md-icon></md-button> <md-button
										class="md-icon-button"
										ng-click="printstockShipment(shipmentEntity.id)">
									<ng-md-icon icon="print" style="fill: md-default" size="20">
									<md-tooltip> Print Product Shipment</md-tooltip></ng-md-icon></md-button></td>
							</tr>
						</tbody>
					</table>
					</md-table-container>
				</div>
			</div>
		</form>
	</div>

	<div layout layout-xs="column">
		<section layout="row" layout-xs="column">
			<md-button class="md-raised md-primary"
				ng-disabled="entityForm.$invalid" ng-click="saveEntity()">Save
			as Draft</md-button>
		</section>
		<md-button class="md-raised md-primary"
			ng-disabled="entityForm.$invalid" ng-click="saveEntity()">Submit</md-button>
		</section>
	</div>
</div>